// Logical configuration information from Storage Array GoldenbergSAN.
// Saved on December 11, 2012
// Firmware package version for Storage Array GoldenbergSAN = 07.35.38.60
// NVSRAM package version for Storage Array GoldenbergSAN = N1532-735890-905

//on error stop;

// Uncomment the two lines below to delete the existing configuration.
//show "Deleting the existing configuration.";
//clear storageArray configuration;



// Storage Array global logical configuration script commands
show "Setting the Storage Array user label to GoldenbergSAN.";
set storageArray userLabel="GoldenbergSAN";

show "Setting the Storage Array media scan rate to 15.";
set storageArray mediaScanRate=15;

// Uncomment the three lines below to remove the default virtual disk (if exists). NOTE: Default virtual disk name is always = "Unnamed".
//on error continue;
//show "Deleting the default virtual disk created during the removal of the existing configuration.";
//delete virtualDisk[""];
//on error stop;

// Copies the hot spare settings
// NOTE: These statements are wrapped in on-error continue and on-error stop statements to
// account for minor differences in capacity from the physical disk of the Storage Array on which the
// configuration was saved to that of the physical disks on which the configuration will be copied.
//on error continue;
show "Creating hot spare at Enclosure 0 Slot 9.";
set physicalDisk[0,9] hotSpare=true;
//on error stop;

show "Setting the Storage Array cache block size to 4.";
set storageArray cacheBlockSize=4;

show "Setting the Storage Array to begin cache flush at 80% full.";
set storageArray cacheFlushStart=80;

show "Setting the Storage Array to end cache flush at 80% full.";
set storageArray cacheFlushStop=80;

// Creating Host Topology
show "Creating Host Group XenHostGroup.";
create hostGroup userLabel="XenHostGroup";

show "Creating Host xenhost1 with Host Type Index 1 on Host Group XenHostGroup.";
// This Host Type Index corresponds to Type Linux
create host userLabel="xenhost1" hostType=1 hostGroup="XenHostGroup";

show "Creating iSCSI Initiator iqn.2010-10.com.xs56host1:b684edca with User Label xenhost10 on Host xenhost1.";
create iscsiInitiator iscsiName="iqn.2010-10.com.xs56host1:b684edca" userLabel="xenhost10" host="xenhost1";

show "Creating iSCSI Initiator iqn.2010-11.com.example:8bb5984a with User Label xenhost11 on Host xenhost1.";
create iscsiInitiator iscsiName="iqn.2010-11.com.example:8bb5984a" userLabel="xenhost11" host="xenhost1";


show "Creating RAID 1 Virtual Disk EXCHDATA on new Disk Group XenGroup2.";
//This command creates disk group <XenGroup2> and the initial virtual disk <EXCHDATA> with offset 0 on the disk group.
// NOTE: For Disk Groups that use all available capacity, the last Virtual Disk on this group is
// created using all remaining capacity by omitting the capacity= virtual disk creation parameter.
create virtualDisk physicalDisks=(0,13 0,11 0,12 0,10) raidLevel=1 userLabel="EXCHDATA" volumeGroupUserLabel="XenGroup2" owner=0 segmentSize=128 dssPreAllocate=true;
show "Setting additional attributes for Virtual Disk EXCHDATA.";
// Configuration settings that can not be set during Virtual Disk creation.
set virtualDisk["EXCHDATA"] cacheFlushModifier=10;
set virtualDisk["EXCHDATA"] cacheWithoutBatteryEnabled=false;
set virtualDisk["EXCHDATA"] mirrorEnabled=false;
set virtualDisk["EXCHDATA"] readCacheEnabled=true;
set virtualDisk["EXCHDATA"] writeCacheEnabled=true;
set virtualDisk["EXCHDATA"] mediaScanEnabled=true;
set virtualDisk["EXCHDATA"] consistencyCheckEnabled=true;
set virtualDisk["EXCHDATA"] readAheadMultiplier=1;
set virtualDisk["EXCHDATA"] modificationPriority=high;
set virtualDisk["EXCHDATA"] preReadRedundancyCheck=false;
show "Creating Virtual Disk-to-LUN Mapping for Virtual Disk EXCHDATA to LUN 0 under Host xenhost1.";
set virtualDisk ["EXCHDATA"] logicalUnitNumber=0 host="xenhost1";

show "Creating RAID 5 Virtual Disk Xenstorage on new Disk Group XenGroup.";
//This command creates disk group <XenGroup> and the initial virtual disk <Xenstorage> with offset 0 on the disk group.
// NOTE: For Disk Groups that use all available capacity, the last Virtual Disk on this group is
// created using all remaining capacity by omitting the capacity= virtual disk creation parameter.
create virtualDisk physicalDisks=(0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8) raidLevel=5 userLabel="Xenstorage" volumeGroupUserLabel="XenGroup" owner=0 segmentSize=128 capacity=4497711562752 Bytes dssPreAllocate=true;
show "Setting additional attributes for Virtual Disk Xenstorage.";
// Configuration settings that can not be set during Virtual Disk creation.
set virtualDisk["Xenstorage"] cacheFlushModifier=10;
set virtualDisk["Xenstorage"] cacheWithoutBatteryEnabled=false;
set virtualDisk["Xenstorage"] mirrorEnabled=false;
set virtualDisk["Xenstorage"] readCacheEnabled=true;
set virtualDisk["Xenstorage"] writeCacheEnabled=true;
set virtualDisk["Xenstorage"] mediaScanEnabled=true;
set virtualDisk["Xenstorage"] consistencyCheckEnabled=true;
set virtualDisk["Xenstorage"] readAheadMultiplier=1;
set virtualDisk["Xenstorage"] modificationPriority=high;
set virtualDisk["Xenstorage"] preReadRedundancyCheck=false;
show "Creating Virtual Disk-to-LUN Mapping for Virtual Disk Xenstorage to LUN 1 under Host xenhost1.";
set virtualDisk ["Xenstorage"] logicalUnitNumber=1 host="xenhost1";
